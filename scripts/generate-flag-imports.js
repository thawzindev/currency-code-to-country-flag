const fs = require("fs");
const path = require("path");

const ratios = ["1x1", "4x3"];
const outputFile = "src/flagImports.ts";

let output = "// Auto-generated file - do not edit manually\n";
output += "// Generated by scripts/generate-flag-imports.js\n\n";

const imports = [];
const exports1x1 = [];
const exports4x3 = [];

ratios.forEach((ratio) => {
  const flagsDir = path.join(__dirname, "..", "src", "assets", "flags", ratio);
  const files = fs.readdirSync(flagsDir).filter((f) => f.endsWith(".svg"));

  files.forEach((file) => {
    const countryCode = file.replace(".svg", "");
    const varName = `flag_${ratio.replace("x", "_")}_${countryCode.replace(
      /-/g,
      "_"
    )}`;

    imports.push(`import ${varName} from './assets/flags/${ratio}/${file}';`);

    if (ratio === "1x1") {
      exports1x1.push(`  '${countryCode}': ${varName}`);
    } else {
      exports4x3.push(`  '${countryCode}': ${varName}`);
    }
  });
});

output += imports.join("\n") + "\n\n";
output += "export const flags1x1: Record<string, string> = {\n";
output += exports1x1.join(",\n") + "\n};\n\n";
output += "export const flags4x3: Record<string, string> = {\n";
output += exports4x3.join(",\n") + "\n};\n";

fs.writeFileSync(path.join(__dirname, "..", outputFile), output);
console.log(`Generated ${outputFile} with ${imports.length} flag imports`);
